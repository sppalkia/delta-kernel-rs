=== Complex Expression Test ===
This test demonstrates the full range of expression types.
Some types are not yet supported in round-trip reconstruction:
  - Struct/Array/Map literals (nested data structures)
  - Transform expressions (schema evolution operations)
  - Opaque expressions (custom user-defined expressions)

StructExpression
  Column(col)
  Byte(127)
  Byte(-128)
  Float(340282346638528859811704183484516925440.000000)
  Float(-340282346638528859811704183484516925440.000000)
  Double(179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000)
  Double(-179769313486231570814527423731704356798070567525844996598917476803157260780028538760589558632766878171540458953514382464234321326889464182768467546703537516986049910576551282076245490090389328944075868508455133942304583236903222948165808559332123348274797826204144723168738177180919299881250404026184124858368.000000)
  Integer(2147483647)
  Integer(-2147483648)
  Long(9223372036854775807)
  Long(-9223372036854775808)
  String(hello expressions)
  Boolean(1)
  Boolean(0)
  Timestamp(50)
  TimestampNtz(100)
  Date(32)
  Binary(0000deadbeefcafe)
  Decimal(1,1,20,3)
  Null
  Struct
    Field: top
      Struct
        Field: a
          Integer(500)
        Field: b
          Array
            Short(5)
            Short(0)
  Transform
    Column(foo.bar.baz)
    Prepend
      String(prepended)
    Insert(a)
      String(first)
      Transform
        Drop(gone)
        Replace(stub)
          String(replaced)
        Insert(x)
          Boolean(1)
        Insert(y)
          Boolean(0)
      String(third)
    Drop(dropme)
    Replace(replaceme)
      Integer(42)
  Array
    Short(5)
    Short(0)
  Map
    String(key1): String(val1)
    String(key2): String(val2)
  StructExpression
    Integer(5)
    Long(20)
  OpaqueExpression(foo)
    Integer(42)
    Double(1.111000)
  Unknown(mystery)
  Divide
    Integer(0)
    Integer(0)
  Multiply
    Integer(0)
    Integer(0)
  Add
    Integer(0)
    Integer(0)
  Minus
    Integer(0)
    Integer(0)
And
  Column(col)
  Boolean(1)
  Boolean(0)
  In
    Integer(10)
    Array
      Short(5)
      Short(0)
  Not
    In
      Integer(10)
      Array
        Short(5)
        Short(0)
  Or
    Equal
      Integer(5)
      Integer(10)
    Not
      Equal
        Integer(20)
        Integer(10)
  Not
    IsNull
      Column(col)
  OpaquePredicate(bar)
    Integer(42)
    Double(1.111000)
  Unknown(intrigue)
  Equal
    Integer(0)
    Integer(0)
  Not
    Equal
      Integer(0)
      Integer(0)
  LessThan
    Integer(0)
    Integer(0)
  Not
    GreaterThan
      Integer(0)
      Integer(0)
  GreaterThan
    Integer(0)
    Integer(0)
  Not
    LessThan
      Integer(0)
      Integer(0)
  Distinct
    Integer(0)
    Integer(0)

=== Simple Round-trip Test ===
This test validates expressions/predicates with full support.
Supported types: primitives (int, long, float, double, bool, string),
  temporal (date, timestamp, timestamp_ntz), binary, decimal, null,
  binary operations (+, -, *, /), struct expressions, predicates (eq, ne, lt, le,
  gt, ge, distinct, is_null, is_not_null, not, and, or)

StructExpression
  Column(simple_col)
  Integer(42)
  Long(100)
  Double(2.500000)
  Boolean(1)
  Boolean(0)
  String(test string)
  Date(19000)
  Timestamp(1234567890)
  TimestampNtz(9876543210)
  Add
    Integer(10)
    Integer(20)
  Minus
    Integer(50)
    Integer(30)
  Multiply
    Integer(5)
    Integer(6)
  Divide
    Integer(100)
    Integer(4)
  StructExpression
    Integer(1)
    Long(2)
    Double(3.000000)

=== Expression Round-trip Test ===
SUCCESS: Round-trip expression matches original!
And
  Column(pred_col)
  Boolean(1)
  Boolean(0)
  Equal
    Integer(10)
    Integer(10)
  Not
    Equal
      Integer(5)
      Integer(10)
  LessThan
    Integer(5)
    Integer(10)
  Not
    GreaterThan
      Integer(10)
      Integer(10)
  GreaterThan
    Integer(20)
    Integer(10)
  Not
    LessThan
      Integer(10)
      Integer(10)
  Distinct
    Integer(1)
    Integer(2)
  IsNull
    Column(nullable_col)
  Not
    IsNull
      Column(nonnull_col)
  Not
    Boolean(0)
  Or
    Equal
      Integer(1)
      Integer(1)
    Equal
      Integer(2)
      Integer(2)

=== Predicate Round-trip Test ===
SUCCESS: Round-trip predicate matches original!
